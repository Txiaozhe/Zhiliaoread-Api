{"version":3,"sources":["../../../app/controller/user.js"],"names":["crypto","require","Controller","UserController","req","ctx","request","body","res","service","user","register","login","name","pass","enc","encrypt","status","token","module","exports"],"mappings":"AAAA;;;;;;;;;;;;AAEA,IAAMA,SAASC,QAAQ,oBAAR,CAAf;AACA,IAAMC,aAAaD,QAAQ,KAAR,EAAeC,UAAlC;;IAEMC,c;;;;;;;;;;;;;;;;;;AAEIC,mB,GAAM,KAAKC,GAAL,CAASC,OAAT,CAAiBC,I;AACzBC,mB;;;uBAEU,KAAKH,GAAL,CAASI,OAAT,CAAiBC,IAAjB,CAAsBC,QAAtB,CAA+BP,GAA/B,C;;;AAAZI,mB;;;;;;;;AAEAA,sBAAM,OAAN;;;;AAGF,qBAAKH,GAAL,CAASE,IAAT,GAAgBC,GAAhB;;;;;;;;;;;;;;;;;;;;;;;;;AAIMJ,mB,GAAM,KAAKC,GAAL,CAASC,OAAT,CAAiBC,I;AACzBC,mB,GAAM,E;;;uBAEW,KAAKH,GAAL,CAASI,OAAT,CAAiBC,IAAjB,CAAsBE,KAAtB,CAA4BR,IAAIS,IAAhC,EAAsCT,IAAIU,IAA1C,C;;;AAAbJ,oB;AACAK,mB,GAAMf,OAAOgB,OAAP,CAAeZ,IAAIU,IAAnB,C;;AACZ,oBAAGJ,KAAK,CAAL,EAAQI,IAAR,KAAiBC,GAApB,EAAyB;AACvBP,wBAAM;AACJS,4BAAQ,CADJ;AAEJC,2BAAO;AAFH,mBAAN;AAID;;;;;;;;AAEDV,sBAAM;AACJS,0BAAQ,GADJ;AAEJC,yBAAO;AAFH,iBAAN;;;;AAMF,qBAAKb,GAAL,CAASE,IAAT,GAAgBC,GAAhB;;;;;;;;;;;;;;;;;;;EAhCyBN,U;;AAoC7BiB,OAAOC,OAAP,GAAiBjB,cAAjB","file":"user.js","sourcesContent":["'use strict';\n\nconst crypto = require('../../utils/crypto');\nconst Controller = require('egg').Controller;\n\nclass UserController extends Controller {\n  async register() {\n    const req = this.ctx.request.body;\n    let res;\n    try {\n      res = await this.ctx.service.user.register(req);\n    } catch (error) {\n      res = 'error';\n    }\n\n    this.ctx.body = res;\n  }\n\n  async login() {\n    const req = this.ctx.request.body;\n    let res = {};\n    try {\n      const user = await this.ctx.service.user.login(req.name, req.pass);\n      const enc = crypto.encrypt(req.pass);\n      if(user[0].pass === enc) {\n        res = {\n          status: 0,\n          token: 'dvewhjdkqwedqwkdjqwdjqwdlkqwdwq'\n        }\n      }\n    } catch (e) {\n      res = {\n        status: 500,\n        token: ''\n      };\n    }\n\n    this.ctx.body = res;\n  }\n}\n\nmodule.exports = UserController;\n"]}